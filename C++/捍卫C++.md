# 捍卫 C++

[#进程](https://dev.to/t/cpp)[#编程](https://dev.to/t/programming)[#c](https://dev.to/t/c)[#讨论](https://dev.to/t/discuss)

## C++的声誉

C++ 经常因其复杂性、高学习曲线而饱受诟病，最重要的是，它不仅会让开发者搬起石头砸自己的脚，甚至可能在这个过程中毁掉自己的整条腿。但这些批评经得起推敲吗？

好吧，在这篇博文中，我旨在解决一些对 C++ 最常见的批评，并对其优点和缺点提供一个平衡的观点。

## C++很“复杂”

C++ 确实是一门复杂的语言，拥有丰富的特性和功能。对于任何你想用 C++ 实现的功能，都有大约十几种不同的方法来实现，每种方法都有其自身的利弊和影响。那么，作为一名开发者，你如何知道哪种方法最适合你的特定用例呢？你当然必须对这门语言有深入的理解才能做出这些决定，对吧？

**并非如此……**我的意思是，别误会我的意思，这确实有帮助，但并非硬性要求。过早优化是万恶之源，而在 C++ 中，你可以编写出完美的代码，而无需担心语言中更复杂的特性。你可以在 C++ 中编写简单、易读且易于维护的代码，而无需使用模板、运算符重载或该语言的任何其他更高级的特性。

有一种观点认为，用任何编程语言做任何事，都需要尽可能使用最高效、最正确的方法。Python 以其 Python 式的做事方式做到了这一点，Java 如此，C# 如此，Go 也如此。哎呀，就连像在浏览器上绘制 HTML 这样简单的事情，也需要每隔几年就重新发明一次，并且争论不休。然而，事实是，在大多数情况下，做某事并没有唯一正确的方法。所谓的“最佳方法”通常只是个人或团队偏好的问题。那种认为只要用“最佳”和正确的方式编写代码，就永远不需要担心维护的想法，简直是错误的。

不要太在意使用“最佳”方法；更要考虑如何编写易于阅读和理解的代码。如果你能做到这一点，就没问题了。

## C++已经“过时”

C++ 的历史非常悠久。事实上，它诞生于 1985 年。确切地说，这比 Windows 的第一个版本发布早了 4 年，比 Linux 的第一个版本发布早了 6 年，或者更确切地说，比最后一台 8 位计算机的发布早了 6 年。所以，无论以何种标准衡量，C++ 都算得上相当古老了。但这就意味着它已经过时了吗？

**当然**，C++ 并非自 1985 年发布以来就一直保持不变。40 多年来，C++ 一直在积极开发和改进，不断添加新的特性和功能。C++ 标准的最新版本 C++ 20 于 2020 年发布，为该语言引入了许多新功能和改进。C++ 23 也即将问世，预计将为该语言带来更多改进。

这些改进中，最关键的是模块、概念、范围和协程。这些特性为 C++ 带来了现代编程范式，使其比以往任何时候都更加强大、更具表现力。

**但是戴夫，我们所说的过时是指其他语言已经超越了 C++ 并提供了更好的开发人员体验。**

我想，这或许只是个人喜好问题，C++ 仍然是最广泛使用的编程语言之一，拥有庞大的库和工具生态系统。它被广泛应用于游戏开发、高性能计算和嵌入式系统等各种领域。世界上许多最流行、使用最广泛的软件应用程序都是用 C++ 编写的。

我并不认为 C++ 已经过时了；你必须对过时的定义进行很大程度的改变才能得出这样的结论。

## C++ 是“不安全的”

啊，终于，我们谈到最重要的问题了，是的，我会将其与 Rust 进行比较，因为它是一种“内存安全”语言，很多人声称它将或应该取代 C++。

**事实上，我们现在就来讨论一下主要观点。**

### 将 C++ 代码库重写为 Rust 总是能比以前产生更内存安全的结果。

无数公司都曾提到，他们只是用 Rust 重写 C++ 代码库，就提高了安全性或减少了报告的错误或内存泄漏的数量。

**这是因为 Rust 吗？**我认为，在某种程度上，是的。然而，我认为最大的因素是，任何对现有代码库的重写都会产生比原始代码库更好的结果。

重写代码库时，您有机会重新思考和设计架构、修复错误并提升代码的整体质量。您可以利用从之前的实现中汲取的所有经验教训、所有已发现和修复的问题以及您已知的问题。所有在现有代码库中难以修复的问题，您都可以在新的代码库中轻松解决。

想象一下，你建了一个棚屋，它有点摇摇晃晃，而且你刚开始建的时候不太懂木工技术，所以它还有一些其他问题，比如结构完整性和屋顶漏水。几年后，你又建了一个新棚屋，这一次你彻底认清了第一次建棚时犯的所有错误，所以你把它建得更好、更坚固、更防风雨。在这个过程中，你决定更换之前使用的材料，比如，你选择橡木而不是枫木。这么说，新棚屋更好只是因为你用橡木代替了枫木，对吗？或者这只是整体改进的一小部分？

当我看到这些公司声称用 Rust 重写他们的 C++ 代码库让他们的内存更安全时，我就是这么想的。这并不是 Rust 的功劳，而是因为他们花时间重新思考和设计了他们的代码库，并吸取了之前实现过程中的所有经验教训。

### 但这并不能否认 C++ 不安全的事实。

是的，如果你不知道自己在做什么，C++ 可能不安全。但问题是：如果你不知道自己在做什么，所有编程语言都是不安全的。你可以在 Rust 中编写不安全的代码，你可以在 Python 中编写不安全的代码，你可以在 JavaScript 中编写不安全的代码。

内存安全只是编程语言安全性的一个方面；你仍然可以用内存安全的编程语言编写不安全的代码。仅仅使用 Rust 并不能神奇地让你的应用程序变得安全；它只会让内存泄漏或安全问题的发生变得更加困难。

在这种情况下，“不安全”一词有点过于模糊，我认为它被用作一个包罗万象的术语，在我看来，这充满了营销语言。

### C++ 可以变得更安全吗？

是的，C++ 可以变得更安全；事实上，它甚至可以做到内存安全。有很多库和工具可以帮助提高 C++ 代码的安全性，例如智能指针、静态分析工具和内存清理工具。甚至，如果你愿意，你甚至可以在 C++ 中添加一个垃圾收集器（如果你真的想这么做的话）（请不要这么做）。

但让 C++ 更安全最简单直接的方法就是学习智能指针，并在必要时使用它们。智能指针是一种在 C++ 中管理内存的方法，无需手动分配和释放内存。它们会自动处理内存管理，大大降低了内存泄漏或悬垂指针的发生概率。这恰恰是 C++ 最初面临的主要批评。

## C++难以阅读

那就别那样写。C++ 是一种多范式编程语言；你可以编写过程式代码、面向对象代码、函数式代码，或者三者混合。如果你愿意，你可以用 C++ 编写简单易读的代码。如果你愿意，你也可以用 C++ 编写复杂且难以理解的代码。这完全取决于个人或团队的偏好。

我对 C++ 的一点经验是：尽可能让它看起来像 C，除非真的需要，否则避免使用太多 C 语言的高级特性。使用智能指针，避免使用原始指针，并尽可能使用标准库。

您只需像使用 C 一样使用 C++ 并仅在真正需要时引入复杂性，就可以完成大量编程工作。

### 但这难道不违背 C++ 的初衷吗？那为什么不直接用 C 呢？

C++ 是 C 的超集，你可以用 C++ 编写 C 代码，而且运行良好。C++ 为 C 增加了许多特性和功能。如果你从 C 开始学习，那么你就只能使用 C 语言了，虽然在很多情况下这没什么问题，但 C++ 允许你在需要时使用更高级的特性。你可以从 C 开始学习，然后根据需要逐步引入 C++ 的特性。如果你不想用，也可以不完全用 C++ 的特性。

再次回到我之前关于棚屋的比喻，如果你用木头搭建了一个棚屋，以后如果需要的话，你随时可以加一个金属屋顶。如果你不想，你不必把整个棚屋都用金属建造。

## C++ 的生态系统令人困惑

C++ 拥有一个庞大的生态系统，历经 40 多年的发展，拥有众多不同的库和工具。这使得我们很难确定应该使用哪些库和工具来完成特定任务。但这并非 C++ 独有，每种编程语言都存在这个问题。

再次强调，简单的经验法则是尽可能使用标准库；它维护良好，并且拥有许多实用的功能。对于网络或 GUI 开发等其他任务，有许多广泛使用且维护良好的知名库。您可以做一些研究，找出最适合您特定用例的库。

**尽量避免使用 Boost。Boost**是一个庞大的库集合，在 C++ 社区中被广泛使用。然而，Boost 中的许多库已经过时，不再维护。它们也往往相当复杂，难以使用。如果可以避免使用 Boost，请尽量避免。

除非您正在编写一个需要 Boost 提供的特定功能的大型复杂应用程序，否则最好使用其他更现代、更易于使用的库。除非确实需要，否则不要在您的应用程序中增加 Boost 的性能开销和二进制文件大小。

## C++ 对于初学者来说不是一个好的选择

编程对初学者来说不是一个好选择，木工对初学者来说不是一个好选择，汽车修理对初学者来说也不是一个好选择。编程很难；学习它需要时间和精力，就像所有事情一样。没有一种通用的语言真正适合初学者；每件事都有其利弊。

事实上，如果你想进入**系统编程或游戏开发之**类的领域，那么从 Python 或 JavaScript 开始学其实没什么用。你最终还是需要学习 C 或 C++。

如果您的目标是成为一名 Web 开发人员或数据科学家，那么请从 Python 或 JavaScript 开始。

如果你只是想在编程行业找一份工作，我不知道，学习 Java 或 C#，这两种都是很棒的语言，虽然受到了很多不应有的憎恨，但却提供了大量的工作机会。

事情是这样的：如果你刚开始学习编程，那么无论你选择哪种语言，都会很难。实际上，我认为从 C 或 C++ 开始比从那些晦涩难懂的编程语言开始要好得多。我进一步指出，从 Python 或 JavaScript 开始，从长远来看是对自己不利的，因为你要牺牲在对某个主题的理解尚且新鲜且易于理解时学习的痛苦，来换取在对现有编程理解有更深入的了解后再学习的痛苦。

但是，这只是我的看法。

## C++ 与 Rust：朋友还是对手？

近年来，Rust 赢得了众多青睐，这并非偶然。它非常重视内存安全，其借用检查器强化了 C++ 通常留给程序员的规则。即便如此，Rust 仍在构建其生态系统，学习曲线可能同样陡峭——只是方式不同。C++ 可能无法避免你搬起石头砸自己的脚，但它提供了数十年久经考验的工具、编译器和库，为从 Chrome 到虚幻引擎的所有应用提供支持。实际上，许多团队将 Rust 和 C++ 结合使用，而不是将它们视为敌人。Rust 在以安全为首要任务的新项目中大放异彩，而 C++ 则继续在遗留系统和性能关键领域占据主导地位。

## 2025 年还会使用 C++ 吗？

简短的回答：绝对如此。尽管人们一直说 C++ 已经过时，但它仍然是世界上使用最广泛的语言之一。Chrome 和 Firefox 等主流浏览器仍然用它编写。虚幻引擎等游戏引擎也运行在它之上。汽车系统、金融交易平台，甚至人工智能框架，在性能和控制方面都严重依赖 C++。新标准（C++20、C++23）不断更新这门语言，确保它与新兴的替代语言保持竞争力。如果你深入研究我们日常依赖的大多数大型系统，你几乎总能发现 C++ 在底层默默地运转。

## 结论

C++ 是一门强大而多功能的编程语言，经受住了时间的考验。尽管它确实存在复杂性和挑战，但它仍然是当今科技领域中一门重要且广泛使用的语言。
只要掌握正确的方法和思维方式，C++ 的使用体验会非常愉悦，并且可以开发出高性能、高效的应用程序。所以，下次你听到有人批评 C++ 时，在彻底否定它之前，请先花点时间思考一下这门古老语言的优势和能力。

[希望你喜欢这篇博文。如果喜欢，请考虑分享给你的朋友和同事。如果你有任何问题或意见，请随时在Twitter](https://twitter.com/dayvster)上联系我。