#### 纯函数

在函数式编程中，**纯函数（Pure Function）** 是指同时满足以下两个条件的函数：

1. **确定性（Deterministic）**：
   - 对于相同的输入，永远返回相同的输出。
   - 函数的行为完全由其输入参数决定，不受任何外部状态的影响。
   - 可以理解为数学中的函数，例如 `f(x) = x + 1`，只要输入 `x` 是 `5`，输出永远是 `6`。
2. **无副作用（No Side Effects）**：
   - 函数的执行不会修改任何外部状态。
   - 这包括：
     - 不修改全局变量。
     - 不修改传入的参数（特别是引用或指针）。
     - 不进行任何 I/O 操作（如打印到控制台、写入文件、网络请求等）。
     - 不抛出异常（虽然在 C++ 中，异常本身是一种控制流，但它也被视为一种副作用，因为它会中断正常的执行流程并将状态传递给调用者）。

**简单来说：纯函数只做一件事 —— 根据输入计算输出，除此之外什么都不做。**

------

### 为什么 “纯洁性” 很重要？

使用纯函数有诸多好处，这也是函数式编程推崇它的原因：

1. **易于推理和调试（Ease of Reasoning & Debugging）**：
   - 由于纯函数与外部世界隔离，你只需要关注它的输入和输出即可理解其逻辑。
   - 不需要追踪复杂的全局状态变化，这使得代码的行为更加可预测。
   - 调试时，你可以直接用特定的输入来调用函数，而不用担心其他地方的代码影响了它的结果。
2. **可缓存性（Memoization）**：
   - 因为对于相同的输入总是产生相同的输出，所以你可以缓存（Memoize）函数的计算结果。
   - 当下次以相同的参数调用时，直接返回缓存的结果，而无需重新计算，这可以极大地提升性能。
3. **可测试性（Testability）**：
   - 编写单元测试变得极其简单。
   - 你只需要提供一系列输入，然后断言（Assert）其输出是否符合预期即可。不需要复杂的测试夹具（Test Fixtures）来设置和清理状态。
4. **线程安全（Thread Safety）**：
   - 纯函数天然是线程安全的。
   - 因为它不读取或修改共享状态，所以在多线程环境中并发调用它不会导致任何数据竞争或不确定性行为。这使得并行计算变得简单。
5. **代码清晰（Code Clarity）**：
   - 纯函数强制你将复杂的逻辑分解为简单、独立的部分。
   - 这有助于构建模块化、高内聚、低耦合的代码库。